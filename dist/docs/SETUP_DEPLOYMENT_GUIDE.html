
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Business Services Hub - Setup & Deployment Guide</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <hr />
<p>layout: default
title: Setup &amp; Deployment Guide
permalink: /docs/SETUP_DEPLOYMENT_GUIDE.md</p>
<hr />
<h1 id="business-services-hub-setup-deployment-guide">üöÄ Business Services Hub - Setup &amp; Deployment Guide</h1>
<h2 id="table-of-contents">üìã Table of Contents</h2>
<ol>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#development-environment-setup">Development Environment Setup</a></li>
<li><a href="#database-setup">Database Setup</a></li>
<li><a href="#environment-configuration">Environment Configuration</a></li>
<li><a href="#local-development">Local Development</a></li>
<li><a href="#production-deployment">Production Deployment</a></li>
<li><a href="#docker-deployment">Docker Deployment</a></li>
<li><a href="#cicd-pipeline">CI/CD Pipeline</a></li>
<li><a href="#monitoring--logging">Monitoring &amp; Logging</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ol>
<hr />
<h2 id="prerequisites">üîß Prerequisites</h2>
<h3 id="system-requirements">System Requirements</h3>
<h4 id="minimum-requirements">Minimum Requirements</h4>
<ul>
<li><strong>Node.js</strong>: Version 18.0 or higher</li>
<li><strong>npm</strong>: Version 8.0 or higher</li>
<li><strong>Git</strong>: Version 2.30 or higher</li>
<li><strong>PostgreSQL</strong>: Version 13 or higher</li>
<li><strong>Redis</strong>: Version 6.0 or higher</li>
</ul>
<h4 id="recommended-requirements">Recommended Requirements</h4>
<ul>
<li><strong>Node.js</strong>: Version 20.0 or higher</li>
<li><strong>npm</strong>: Version 9.0 or higher</li>
<li><strong>Git</strong>: Latest version</li>
<li><strong>PostgreSQL</strong>: Version 15 or higher</li>
<li><strong>Redis</strong>: Version 7.0 or higher</li>
<li><strong>Docker</strong>: Version 20.10 or higher</li>
<li><strong>Docker Compose</strong>: Version 2.0 or higher</li>
</ul>
<h3 id="required-accounts-services">Required Accounts &amp; Services</h3>
<h4 id="essential-services">Essential Services</h4>
<ul>
<li><strong>Supabase Account</strong>: Database and authentication</li>
<li><strong>Stripe Account</strong>: Payment processing</li>
<li><strong>SendGrid Account</strong>: Email services</li>
<li><strong>Twilio Account</strong>: SMS services</li>
<li><strong>Google Cloud Platform</strong>: Maps and additional services</li>
</ul>
<h4 id="optional-services">Optional Services</h4>
<ul>
<li><strong>AWS Account</strong>: Cloud hosting and services</li>
<li><strong>CloudFlare Account</strong>: CDN and security</li>
<li><strong>Sentry Account</strong>: Error monitoring</li>
<li><strong>LogRocket Account</strong>: User session monitoring</li>
</ul>
<hr />
<h2 id="development-environment-setup">üõ†Ô∏è Development Environment Setup</h2>
<h3 id="1-clone-the-repository">1. Clone the Repository</h3>
<pre><code class="language-bash"># Clone the main repository
git clone https://github.com/your-org/business-services-hub.git
cd business-services-hub

# Install dependencies
npm install
</code></pre>
<h3 id="2-install-required-tools">2. Install Required Tools</h3>
<h4 id="nodejs-and-npm">Node.js and npm</h4>
<pre><code class="language-bash"># Check current versions
node --version
npm --version

# Install Node.js (if needed)
# Using Node Version Manager (nvm)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 20
nvm use 20

# Or download from https://nodejs.org/
</code></pre>
<h4 id="git-configuration">Git Configuration</h4>
<pre><code class="language-bash"># Configure Git
git config --global user.name &quot;Your Name&quot;
git config --global user.email &quot;your.email@example.com&quot;

# Set up SSH key (optional but recommended)
ssh-keygen -t rsa -b 4096 -C &quot;your.email@example.com&quot;
</code></pre>
<h4 id="database-tools">Database Tools</h4>
<pre><code class="language-bash"># Install PostgreSQL (macOS with Homebrew)
brew install postgresql
brew services start postgresql

# Install PostgreSQL (Ubuntu/Debian)
sudo apt update
sudo apt install postgresql postgresql-contrib

# Install Redis (macOS with Homebrew)
brew install redis
brew services start redis

# Install Redis (Ubuntu/Debian)
sudo apt install redis-server
sudo systemctl start redis-server
</code></pre>
<h3 id="3-ide-and-development-tools">3. IDE and Development Tools</h3>
<h4 id="recommended-ides">Recommended IDEs</h4>
<ul>
<li><strong>Visual Studio Code</strong> with extensions:</li>
<li>ES7+ React/Redux/React-Native snippets</li>
<li>TypeScript Importer</li>
<li>Prettier - Code formatter</li>
<li>ESLint</li>
<li>GitLens</li>
<li>Thunder Client (API testing)</li>
</ul>
<h4 id="development-tools">Development Tools</h4>
<pre><code class="language-bash"># Install global development tools
npm install -g @supabase/cli
npm install -g typescript
npm install -g ts-node
npm install -g nodemon
npm install -g pm2
</code></pre>
<hr />
<h2 id="database-setup">üóÑÔ∏è Database Setup</h2>
<h3 id="1-supabase-setup">1. Supabase Setup</h3>
<h4 id="create-supabase-project">Create Supabase Project</h4>
<ol>
<li>Go to <a href="https://app.supabase.com">Supabase Dashboard</a></li>
<li>Click "New Project"</li>
<li>Choose organization and enter project details</li>
<li>Select region and database password</li>
<li>Wait for project creation (2-3 minutes)</li>
</ol>
<h4 id="install-supabase-cli">Install Supabase CLI</h4>
<pre><code class="language-bash"># Install Supabase CLI
npm install -g @supabase/cli

# Login to Supabase
supabase login

# Link to your project
supabase link --project-ref your-project-ref
</code></pre>
<h4 id="database-schema-setup">Database Schema Setup</h4>
<pre><code class="language-bash"># Pull existing schema
supabase db pull

# Apply migrations
supabase db push

# Generate TypeScript types
supabase gen types typescript --local &gt; src/types/database.types.ts
</code></pre>
<h3 id="2-local-database-setup-alternative">2. Local Database Setup (Alternative)</h3>
<h4 id="postgresql-setup">PostgreSQL Setup</h4>
<pre><code class="language-bash"># Create database
createdb business_services_hub

# Create user
psql -c &quot;CREATE USER bsh_user WITH PASSWORD 'your_password';&quot;
psql -c &quot;GRANT ALL PRIVILEGES ON DATABASE business_services_hub TO bsh_user;&quot;

# Connect to database
psql -d business_services_hub -U bsh_user
</code></pre>
<h4 id="database-schema">Database Schema</h4>
<pre><code class="language-sql">-- Create tables
\i scripts/schema.sql

-- Insert seed data
\i scripts/seed.sql
</code></pre>
<h3 id="3-redis-setup">3. Redis Setup</h3>
<h4 id="local-redis">Local Redis</h4>
<pre><code class="language-bash"># Start Redis server
redis-server

# Test Redis connection
redis-cli ping
# Should return: PONG
</code></pre>
<h4 id="redis-configuration">Redis Configuration</h4>
<pre><code class="language-bash"># Edit Redis configuration
sudo nano /etc/redis/redis.conf

# Key settings:
# bind 127.0.0.1
# port 6379
# requirepass your_redis_password
# maxmemory 256mb
# maxmemory-policy allkeys-lru
</code></pre>
<hr />
<h2 id="environment-configuration">‚öôÔ∏è Environment Configuration</h2>
<h3 id="1-environment-variables">1. Environment Variables</h3>
<h4 id="create-environment-files">Create Environment Files</h4>
<pre><code class="language-bash"># Copy example environment file
cp .env.example .env.local

# Copy production environment file
cp .env.example .env.production
</code></pre>
<h4 id="development-environment-envlocal">Development Environment (.env.local)</h4>
<pre><code class="language-env"># Database
DATABASE_URL=postgresql://bsh_user:your_password@localhost:5432/business_services_hub
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# Redis
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your_redis_password

# Authentication
JWT_SECRET=your-jwt-secret-key
JWT_EXPIRES_IN=7d
REFRESH_TOKEN_SECRET=your-refresh-token-secret

# Payment Processing
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Email Service
SENDGRID_API_KEY=SG.your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@yourdomain.com

# SMS Service
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890

# Google Services
GOOGLE_MAPS_API_KEY=your_google_maps_api_key
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# Application
NODE_ENV=development
PORT=3000
API_BASE_URL=http://localhost:3000/api
CLIENT_BASE_URL=http://localhost:3001

# File Upload
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp

# Security
CORS_ORIGIN=http://localhost:3001
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Monitoring
SENTRY_DSN=your_sentry_dsn
LOG_LEVEL=debug
</code></pre>
<h4 id="production-environment-envproduction">Production Environment (.env.production)</h4>
<pre><code class="language-env"># Database
DATABASE_URL=postgresql://username:password@host:port/database
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# Redis
REDIS_URL=redis://username:password@host:port
REDIS_PASSWORD=your_redis_password

# Authentication
JWT_SECRET=your-production-jwt-secret-key
JWT_EXPIRES_IN=7d
REFRESH_TOKEN_SECRET=your-production-refresh-token-secret

# Payment Processing
STRIPE_PUBLISHABLE_KEY=pk_live_your_stripe_publishable_key
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Email Service
SENDGRID_API_KEY=SG.your_production_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@yourdomain.com

# SMS Service
TWILIO_ACCOUNT_SID=your_production_twilio_account_sid
TWILIO_AUTH_TOKEN=your_production_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890

# Google Services
GOOGLE_MAPS_API_KEY=your_production_google_maps_api_key
GOOGLE_CLIENT_ID=your_production_google_client_id
GOOGLE_CLIENT_SECRET=your_production_google_client_secret

# Application
NODE_ENV=production
PORT=3000
API_BASE_URL=https://api.yourdomain.com
CLIENT_BASE_URL=https://yourdomain.com

# File Upload
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp

# Security
CORS_ORIGIN=https://yourdomain.com
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Monitoring
SENTRY_DSN=your_production_sentry_dsn
LOG_LEVEL=info
</code></pre>
<h3 id="2-service-configuration">2. Service Configuration</h3>
<h4 id="supabase-configuration">Supabase Configuration</h4>
<ol>
<li>Go to Supabase Dashboard ‚Üí Settings ‚Üí API</li>
<li>Copy Project URL and API keys</li>
<li>Configure Row Level Security (RLS) policies</li>
<li>Set up authentication providers</li>
<li>Configure storage buckets</li>
</ol>
<h4 id="stripe-configuration">Stripe Configuration</h4>
<ol>
<li>Go to Stripe Dashboard ‚Üí Developers ‚Üí API keys</li>
<li>Copy publishable and secret keys</li>
<li>Set up webhook endpoints</li>
<li>Configure payment methods</li>
<li>Set up tax settings</li>
</ol>
<h4 id="sendgrid-configuration">SendGrid Configuration</h4>
<ol>
<li>Go to SendGrid Dashboard ‚Üí Settings ‚Üí API keys</li>
<li>Create API key with full access</li>
<li>Verify sender identity</li>
<li>Set up domain authentication</li>
<li>Configure email templates</li>
</ol>
<hr />
<h2 id="local-development">üíª Local Development</h2>
<h3 id="1-start-development-server">1. Start Development Server</h3>
<h4 id="backend-development">Backend Development</h4>
<pre><code class="language-bash"># Install dependencies
npm install

# Start development server
npm run dev

# Or with specific environment
NODE_ENV=development npm run dev

# With debugging
DEBUG=app:* npm run dev
</code></pre>
<h4 id="frontend-development">Frontend Development</h4>
<pre><code class="language-bash"># Navigate to frontend directory
cd frontend

# Install dependencies
npm install

# Start development server
npm run dev

# Or with specific port
PORT=3001 npm run dev
</code></pre>
<h4 id="full-stack-development">Full Stack Development</h4>
<pre><code class="language-bash"># Start both backend and frontend
npm run dev:full

# Or using concurrently
npm run dev:concurrent
</code></pre>
<h3 id="2-database-operations">2. Database Operations</h3>
<h4 id="run-migrations">Run Migrations</h4>
<pre><code class="language-bash"># Run pending migrations
npm run db:migrate

# Rollback last migration
npm run db:rollback

# Reset database
npm run db:reset

# Seed database
npm run db:seed
</code></pre>
<h4 id="database-management">Database Management</h4>
<pre><code class="language-bash"># Open database console
npm run db:console

# Backup database
npm run db:backup

# Restore database
npm run db:restore
</code></pre>
<h3 id="3-testing">3. Testing</h3>
<h4 id="run-tests">Run Tests</h4>
<pre><code class="language-bash"># Run all tests
npm test

# Run specific test suite
npm run test:unit
npm run test:integration
npm run test:e2e

# Run tests with coverage
npm run test:coverage

# Run tests in watch mode
npm run test:watch
</code></pre>
<h4 id="test-database-setup">Test Database Setup</h4>
<pre><code class="language-bash"># Set up test database
npm run test:db:setup

# Clean test database
npm run test:db:clean

# Run tests with fresh database
npm run test:fresh
</code></pre>
<h3 id="4-code-quality">4. Code Quality</h3>
<h4 id="linting-and-formatting">Linting and Formatting</h4>
<pre><code class="language-bash"># Run ESLint
npm run lint

# Fix ESLint issues
npm run lint:fix

# Run Prettier
npm run format

# Check code formatting
npm run format:check
</code></pre>
<h4 id="type-checking">Type Checking</h4>
<pre><code class="language-bash"># Run TypeScript compiler
npm run type-check

# Watch for type changes
npm run type-check:watch
</code></pre>
<hr />
<h2 id="production-deployment">üöÄ Production Deployment</h2>
<h3 id="1-server-preparation">1. Server Preparation</h3>
<h4 id="system-requirements_1">System Requirements</h4>
<ul>
<li><strong>CPU</strong>: 2+ cores</li>
<li><strong>RAM</strong>: 4GB+ (8GB recommended)</li>
<li><strong>Storage</strong>: 50GB+ SSD</li>
<li><strong>OS</strong>: Ubuntu 20.04+ or CentOS 8+</li>
</ul>
<h4 id="server-setup">Server Setup</h4>
<pre><code class="language-bash"># Update system
sudo apt update &amp;&amp; sudo apt upgrade -y

# Install Node.js
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# Install PM2
sudo npm install -g pm2

# Install Nginx
sudo apt install nginx -y

# Install PostgreSQL
sudo apt install postgresql postgresql-contrib -y

# Install Redis
sudo apt install redis-server -y
</code></pre>
<h3 id="2-application-deployment">2. Application Deployment</h3>
<h4 id="clone-and-setup">Clone and Setup</h4>
<pre><code class="language-bash"># Clone repository
git clone https://github.com/your-org/business-services-hub.git
cd business-services-hub

# Install dependencies
npm ci --production

# Build application
npm run build

# Set up environment
cp .env.production .env
</code></pre>
<h4 id="database-setup_1">Database Setup</h4>
<pre><code class="language-bash"># Create production database
sudo -u postgres createdb business_services_hub_prod

# Create user
sudo -u postgres psql -c &quot;CREATE USER bsh_prod WITH PASSWORD 'secure_password';&quot;
sudo -u postgres psql -c &quot;GRANT ALL PRIVILEGES ON DATABASE business_services_hub_prod TO bsh_prod;&quot;

# Run migrations
npm run db:migrate
</code></pre>
<h4 id="start-application">Start Application</h4>
<pre><code class="language-bash"># Start with PM2
pm2 start ecosystem.config.js

# Save PM2 configuration
pm2 save

# Setup PM2 startup
pm2 startup
</code></pre>
<h3 id="3-nginx-configuration">3. Nginx Configuration</h3>
<h4 id="nginx-setup">Nginx Setup</h4>
<pre><code class="language-bash"># Create Nginx configuration
sudo nano /etc/nginx/sites-available/business-services-hub
</code></pre>
<h4 id="nginx-configuration">Nginx Configuration</h4>
<pre><code class="language-nginx">server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;

    # Redirect HTTP to HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name yourdomain.com www.yourdomain.com;

    # SSL Configuration
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;

    # Security Headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection &quot;1; mode=block&quot;;
    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot; always;

    # API Routes
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # Static Files
    location / {
        root /var/www/business-services-hub/dist;
        try_files $uri $uri/ /index.html;

        # Cache static assets
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control &quot;public, immutable&quot;;
        }
    }

    # File Upload Size
    client_max_body_size 10M;
}
</code></pre>
<h4 id="enable-site">Enable Site</h4>
<pre><code class="language-bash"># Enable site
sudo ln -s /etc/nginx/sites-available/business-services-hub /etc/nginx/sites-enabled/

# Test configuration
sudo nginx -t

# Restart Nginx
sudo systemctl restart nginx
</code></pre>
<h3 id="4-ssl-certificate">4. SSL Certificate</h3>
<h4 id="lets-encrypt-setup">Let's Encrypt Setup</h4>
<pre><code class="language-bash"># Install Certbot
sudo apt install certbot python3-certbot-nginx -y

# Obtain SSL certificate
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com

# Test renewal
sudo certbot renew --dry-run
</code></pre>
<hr />
<h2 id="docker-deployment">üê≥ Docker Deployment</h2>
<h3 id="1-docker-configuration">1. Docker Configuration</h3>
<h4 id="dockerfile">Dockerfile</h4>
<pre><code class="language-dockerfile"># Use Node.js 20 Alpine
FROM node:20-alpine

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci --only=production

# Copy source code
COPY . .

# Build application
RUN npm run build

# Expose port
EXPOSE 3000

# Start application
CMD [&quot;npm&quot;, &quot;start&quot;]
</code></pre>
<h4 id="docker-compose">Docker Compose</h4>
<pre><code class="language-yaml">version: '3.8'

services:
  app:
    build: .
    ports:
      - '3000:3000'
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgresql://bsh_user:password@db:5432/business_services_hub
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis
    volumes:
      - ./uploads:/app/uploads

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_DB=business_services_hub
      - POSTGRES_USER=bsh_user
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - '5432:5432'

  redis:
    image: redis:7-alpine
    ports:
      - '6379:6379'
    volumes:
      - redis_data:/data

  nginx:
    image: nginx:alpine
    ports:
      - '80:80'
      - '443:443'
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/ssl
    depends_on:
      - app

volumes:
  postgres_data:
  redis_data:
</code></pre>
<h3 id="2-docker-deployment">2. Docker Deployment</h3>
<h4 id="build-and-run">Build and Run</h4>
<pre><code class="language-bash"># Build images
docker-compose build

# Start services
docker-compose up -d

# View logs
docker-compose logs -f

# Stop services
docker-compose down
</code></pre>
<h4 id="production-deployment_1">Production Deployment</h4>
<pre><code class="language-bash"># Build production image
docker build -t business-services-hub:latest .

# Run production container
docker run -d \
  --name business-services-hub \
  -p 3000:3000 \
  -e NODE_ENV=production \
  -e DATABASE_URL=your_database_url \
  business-services-hub:latest
</code></pre>
<hr />
<h2 id="cicd-pipeline">üîÑ CI/CD Pipeline</h2>
<h3 id="1-github-actions">1. GitHub Actions</h3>
<h4 id="workflow-configuration">Workflow Configuration</h4>
<pre><code class="language-yaml">name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: test_db
        options: &gt;-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

      redis:
        image: redis:7
        options: &gt;-
          --health-cmd &quot;redis-cli ping&quot;
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run tests
        run: npm test
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test_db
          REDIS_URL: redis://localhost:6379

      - name: Run linting
        run: npm run lint

      - name: Run type checking
        run: npm run type-check

  build:
    needs: test
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build application
        run: npm run build

      - name: Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: build-files
          path: dist/

  deploy:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v3

      - name: Deploy to production
        run: |
          # Add your deployment commands here
          echo &quot;Deploying to production...&quot;
</code></pre>
<h3 id="2-deployment-scripts">2. Deployment Scripts</h3>
<h4 id="deploy-script">Deploy Script</h4>
<pre><code class="language-bash">#!/bin/bash
# deploy.sh

set -e

echo &quot;Starting deployment...&quot;

# Pull latest code
git pull origin main

# Install dependencies
npm ci --production

# Run migrations
npm run db:migrate

# Build application
npm run build

# Restart services
pm2 restart business-services-hub

echo &quot;Deployment completed successfully!&quot;
</code></pre>
<hr />
<h2 id="monitoring-logging">üìä Monitoring &amp; Logging</h2>
<h3 id="1-application-monitoring">1. Application Monitoring</h3>
<h4 id="pm2-monitoring">PM2 Monitoring</h4>
<pre><code class="language-bash"># Monitor application
pm2 monit

# View logs
pm2 logs business-services-hub

# View specific log
pm2 logs business-services-hub --lines 100

# Restart application
pm2 restart business-services-hub

# Reload application
pm2 reload business-services-hub
</code></pre>
<h4 id="health-checks">Health Checks</h4>
<pre><code class="language-bash"># Create health check script
cat &gt; health-check.sh &lt;&lt; 'EOF'
#!/bin/bash

# Check if application is running
if ! curl -f http://localhost:3000/health &gt; /dev/null 2&gt;&amp;1; then
    echo &quot;Application is not responding&quot;
    pm2 restart business-services-hub
    exit 1
fi

echo &quot;Application is healthy&quot;
EOF

chmod +x health-check.sh

# Add to crontab for regular checks
(crontab -l 2&gt;/dev/null; echo &quot;*/5 * * * * /path/to/health-check.sh&quot;) | crontab -
</code></pre>
<h3 id="2-log-management">2. Log Management</h3>
<h4 id="log-rotation">Log Rotation</h4>
<pre><code class="language-bash"># Install logrotate
sudo apt install logrotate -y

# Create logrotate configuration
sudo nano /etc/logrotate.d/business-services-hub
</code></pre>
<h4 id="logrotate-configuration">Logrotate Configuration</h4>
<pre><code>/var/log/business-services-hub/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 root root
    postrotate
        pm2 reload business-services-hub
    endscript
}
</code></pre>
<h3 id="3-error-monitoring">3. Error Monitoring</h3>
<h4 id="sentry-integration">Sentry Integration</h4>
<pre><code class="language-javascript">// sentry.js
const Sentry = require('@sentry/node');

Sentry.init({
  dsn: process.env.SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 1.0,
});

module.exports = Sentry;
</code></pre>
<hr />
<h2 id="troubleshooting">üîß Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="1-database-connection-issues">1. Database Connection Issues</h4>
<pre><code class="language-bash"># Check database status
sudo systemctl status postgresql

# Check database logs
sudo journalctl -u postgresql

# Test database connection
psql -h localhost -U bsh_user -d business_services_hub

# Reset database password
sudo -u postgres psql -c &quot;ALTER USER bsh_user PASSWORD 'new_password';&quot;
</code></pre>
<h4 id="2-redis-connection-issues">2. Redis Connection Issues</h4>
<pre><code class="language-bash"># Check Redis status
sudo systemctl status redis

# Check Redis logs
sudo journalctl -u redis

# Test Redis connection
redis-cli ping

# Check Redis configuration
redis-cli config get &quot;*&quot;
</code></pre>
<h4 id="3-application-issues">3. Application Issues</h4>
<pre><code class="language-bash"># Check application logs
pm2 logs business-services-hub

# Check application status
pm2 status

# Restart application
pm2 restart business-services-hub

# Check system resources
htop
df -h
free -h
</code></pre>
<h4 id="4-nginx-issues">4. Nginx Issues</h4>
<pre><code class="language-bash"># Check Nginx status
sudo systemctl status nginx

# Check Nginx configuration
sudo nginx -t

# Check Nginx logs
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log

# Reload Nginx
sudo systemctl reload nginx
</code></pre>
<h3 id="performance-optimization">Performance Optimization</h3>
<h4 id="1-database-optimization">1. Database Optimization</h4>
<pre><code class="language-sql">-- Check slow queries
SELECT query, mean_time, calls, total_time
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;

-- Analyze table statistics
ANALYZE;

-- Check index usage
SELECT schemaname, tablename, attname, n_distinct, correlation
FROM pg_stats
WHERE tablename = 'your_table_name';
</code></pre>
<h4 id="2-application-optimization">2. Application Optimization</h4>
<pre><code class="language-bash"># Monitor memory usage
pm2 monit

# Check CPU usage
top -p $(pgrep -f &quot;node.*business-services-hub&quot;)

# Monitor network connections
netstat -tulpn | grep :3000

# Check file descriptors
lsof -p $(pgrep -f &quot;node.*business-services-hub&quot;)
</code></pre>
<h3 id="security-checklist">Security Checklist</h3>
<h4 id="1-server-security">1. Server Security</h4>
<ul>
<li>[ ] Firewall configured (UFW)</li>
<li>[ ] SSH key authentication only</li>
<li>[ ] Regular security updates</li>
<li>[ ] Fail2ban installed and configured</li>
<li>[ ] SSL certificate valid and auto-renewing</li>
</ul>
<h4 id="2-application-security">2. Application Security</h4>
<ul>
<li>[ ] Environment variables secured</li>
<li>[ ] Database credentials encrypted</li>
<li>[ ] API rate limiting enabled</li>
<li>[ ] CORS properly configured</li>
<li>[ ] Input validation implemented</li>
<li>[ ] SQL injection prevention</li>
<li>[ ] XSS protection enabled</li>
</ul>
<h4 id="3-database-security">3. Database Security</h4>
<ul>
<li>[ ] Database user permissions minimal</li>
<li>[ ] Row Level Security (RLS) enabled</li>
<li>[ ] Regular backups configured</li>
<li>[ ] Database encryption at rest</li>
<li>[ ] Connection encryption enabled</li>
</ul>
<hr />
<h2 id="additional-resources">üìö Additional Resources</h2>
<h3 id="documentation-links">Documentation Links</h3>
<ul>
<li><a href="https://nodejs.org/docs/">Node.js Documentation</a></li>
<li><a href="https://www.postgresql.org/docs/">PostgreSQL Documentation</a></li>
<li><a href="https://redis.io/documentation">Redis Documentation</a></li>
<li><a href="https://pm2.keymetrics.io/docs/">PM2 Documentation</a></li>
<li><a href="https://nginx.org/en/docs/">Nginx Documentation</a></li>
<li><a href="https://docs.docker.com/">Docker Documentation</a></li>
</ul>
<h3 id="support-channels">Support Channels</h3>
<ul>
<li><strong>GitHub Issues</strong>: <a href="https://github.com/your-org/business-services-hub/issues">Create an issue</a></li>
<li><strong>Discord Community</strong>: <a href="https://discord.gg/your-discord">Join our Discord</a></li>
<li><strong>Email Support</strong>: support@yourdomain.com</li>
<li><strong>Documentation</strong>: <a href="https://docs.yourdomain.com">Read the docs</a></li>
</ul>
<hr />
<p>This comprehensive setup and deployment guide provides step-by-step instructions for setting up the Business Services Hub in development and production environments, including troubleshooting tips and best practices for maintaining a healthy deployment.</p>
    </div>
</body>
</html>
